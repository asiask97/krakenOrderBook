var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},e={},r={},o=t.parcelRequirece02;null==o&&((o=function(t){if(t in e)return e[t].exports;if(t in r){var o=r[t];delete r[t];var i={id:t,exports:{}};return e[t]=i,o.call(i.exports,i,i.exports),i.exports}var s=new Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(t,e){r[t]=e},t.parcelRequirece02=o),o.register("9RO1v",(function(t,e){var r=o("gDbIF");function i(t){this.data=t,this.left=null,this.right=null,this.red=!0}function s(t){this._root=null,this._comparator=t,this.size=0}function l(t){return null!==t&&t.red}function n(t,e){var r=t.get_child(!e);return t.set_child(!e,r.get_child(e)),r.set_child(e,t),t.red=!0,r.red=!1,r}function a(t,e){return t.set_child(!e,n(t.get_child(!e),!e)),n(t,e)}i.prototype.get_child=function(t){return t?this.right:this.left},i.prototype.set_child=function(t,e){t?this.right=e:this.left=e},s.prototype=new r,s.prototype.insert=function(t){var e=!1;if(null===this._root)this._root=new i(t),e=!0,this.size++;else{var r=new i(void 0),o=0,s=0,u=null,h=r,c=null,d=this._root;for(h.right=this._root;;){if(null===d?(d=new i(t),c.set_child(o,d),e=!0,this.size++):l(d.left)&&l(d.right)&&(d.red=!0,d.left.red=!1,d.right.red=!1),l(d)&&l(c)){var _=h.right===u;d===c.get_child(s)?h.set_child(_,n(u,!s)):h.set_child(_,a(u,!s))}var f=this._comparator(d.data,t);if(0===f)break;s=o,o=f<0,null!==u&&(h=u),u=c,c=d,d=d.get_child(o)}this._root=r.right}return this._root.red=!1,e},s.prototype.remove=function(t){if(null===this._root)return!1;var e=new i(void 0),r=e;r.right=this._root;for(var o=null,s=null,u=null,h=1;null!==r.get_child(h);){var c=h;s=o,o=r,r=r.get_child(h);var d=this._comparator(t,r.data);if(h=d>0,0===d&&(u=r),!l(r)&&!l(r.get_child(h)))if(l(r.get_child(!h))){var _=n(r,h);o.set_child(c,_),o=_}else if(!l(r.get_child(!h))){var f=o.get_child(!c);if(null!==f)if(l(f.get_child(!c))||l(f.get_child(c))){var p=s.right===o;l(f.get_child(c))?s.set_child(p,a(o,c)):l(f.get_child(!c))&&s.set_child(p,n(o,c));var g=s.get_child(p);g.red=!0,r.red=!0,g.left.red=!1,g.right.red=!1}else o.red=!1,f.red=!0,r.red=!0}}return null!==u&&(u.data=r.data,o.set_child(o.right===r,r.get_child(null===r.left)),this.size--),this._root=e.right,null!==this._root&&(this._root.red=!1),null!==u},t.exports=s})),o.register("gDbIF",(function(t,e){function r(){}function o(t){this._tree=t,this._ancestors=[],this._cursor=null}r.prototype.clear=function(){this._root=null,this.size=0},r.prototype.find=function(t){for(var e=this._root;null!==e;){var r=this._comparator(t,e.data);if(0===r)return e.data;e=e.get_child(r>0)}return null},r.prototype.findIter=function(t){for(var e=this._root,r=this.iterator();null!==e;){var o=this._comparator(t,e.data);if(0===o)return r._cursor=e,r;r._ancestors.push(e),e=e.get_child(o>0)}return null},r.prototype.lowerBound=function(t){for(var e=this._root,r=this.iterator(),o=this._comparator;null!==e;){var i=o(t,e.data);if(0===i)return r._cursor=e,r;r._ancestors.push(e),e=e.get_child(i>0)}for(var s=r._ancestors.length-1;s>=0;--s)if(o(t,(e=r._ancestors[s]).data)<0)return r._cursor=e,r._ancestors.length=s,r;return r._ancestors.length=0,r},r.prototype.upperBound=function(t){for(var e=this.lowerBound(t),r=this._comparator;null!==e.data()&&0===r(e.data(),t);)e.next();return e},r.prototype.min=function(){var t=this._root;if(null===t)return null;for(;null!==t.left;)t=t.left;return t.data},r.prototype.max=function(){var t=this._root;if(null===t)return null;for(;null!==t.right;)t=t.right;return t.data},r.prototype.iterator=function(){return new o(this)},r.prototype.each=function(t){for(var e,r=this.iterator();null!==(e=r.next());)if(!1===t(e))return},r.prototype.reach=function(t){for(var e,r=this.iterator();null!==(e=r.prev());)if(!1===t(e))return},o.prototype.data=function(){return null!==this._cursor?this._cursor.data:null},o.prototype.next=function(){if(null===this._cursor){var t=this._tree._root;null!==t&&this._minNode(t)}else if(null===this._cursor.right){var e;do{if(e=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.right===e)}else this._ancestors.push(this._cursor),this._minNode(this._cursor.right);return null!==this._cursor?this._cursor.data:null},o.prototype.prev=function(){if(null===this._cursor){var t=this._tree._root;null!==t&&this._maxNode(t)}else if(null===this._cursor.left){var e;do{if(e=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.left===e)}else this._ancestors.push(this._cursor),this._maxNode(this._cursor.left);return null!==this._cursor?this._cursor.data:null},o.prototype._minNode=function(t){for(;null!==t.left;)this._ancestors.push(t),t=t.left;this._cursor=t},o.prototype._maxNode=function(t){for(;null!==t.right;)this._ancestors.push(t),t=t.right;this._cursor=t},t.exports=r})),o.register("chut6",(function(t,e){var r=o("gDbIF");function i(t){this.data=t,this.left=null,this.right=null}function s(t){this._root=null,this._comparator=t,this.size=0}i.prototype.get_child=function(t){return t?this.right:this.left},i.prototype.set_child=function(t,e){t?this.right=e:this.left=e},s.prototype=new r,s.prototype.insert=function(t){if(null===this._root)return this._root=new i(t),this.size++,!0;for(var e=0,r=null,o=this._root;;){if(null===o)return o=new i(t),r.set_child(e,o),ret=!0,this.size++,!0;if(0===this._comparator(o.data,t))return!1;e=this._comparator(o.data,t)<0,r=o,o=o.get_child(e)}},s.prototype.remove=function(t){if(null===this._root)return!1;var e=new i(void 0),r=e;r.right=this._root;for(var o=null,s=null,l=1;null!==r.get_child(l);){o=r,r=r.get_child(l);var n=this._comparator(t,r.data);l=n>0,0===n&&(s=r)}return null!==s&&(s.data=r.data,o.set_child(o.right===r,r.get_child(null===r.left)),this._root=e.right,this.size--,!0)},t.exports=s}));var i={RBTree:o("9RO1v"),BinTree:o("chut6")}.RBTree;ws=new WebSocket("wss://futures.kraken.com/ws/v1");const s=document.getElementById("chartBids"),l=document.getElementById("chartAsks");let n=new i((function(t,e){return t.key-e.key})),a=new i((function(t,e){return t.key-e.key}));function u(t,e,r){if(0==Object.values(r)[5])t.remove({key:parseFloat(Object.values(r)[4])});else{t.find({key:parseFloat(Object.values(r)[4])})?(t.remove({key:parseFloat(Object.values(r)[4])}),t.insert({key:parseFloat(Object.values(r)[4]),value:parseFloat(Object.values(r)[5])})):t.insert({key:parseFloat(Object.values(r)[4]),value:parseFloat(Object.values(r)[5])})}f(t,e)}ws.onopen=()=>{console.log("Trade WS with Kraken connected"),setTimeout((function(){let t={event:"subscribe",feed:"book",product_ids:["PI_ETHUSD"]};ws.send(JSON.stringify(t))}),3e3)},ws.onmessage=t=>{let e=JSON.parse(t.data);if(!e.event)if("book_snapshot"==Object.values(e)[0]){let t=Object.values(e)[6],r=Object.values(e)[5];t.forEach((t=>{let e=parseFloat(Object.values(t)[0]),r=parseFloat(Object.values(t)[1]);n.insert({key:e,value:r})})),r.forEach((t=>{let e=parseFloat(Object.values(t)[0]),r=parseFloat(Object.values(t)[1]);a.insert({key:e,value:r})})),console.log("Initialised Book"),f(a,"bids"),chartbids=new Chart(s,{type:"bar",data:{labels:d,datasets:[{label:"order size",data:_,borderWidth:1,backgroundColor:["rgb(255,0,0)"]}]},options:{normalized:!0,animation:{duration:0},y:{min:0,max:2e5,ticks:{stepSize:1e4}}}}),f(n,"asks"),chartasks=new Chart(l,{type:"bar",data:{labels:d,datasets:[{label:"order size",data:_,borderWidth:1,backgroundColor:["rgb(0,255,0)"]}]},options:{normalized:!0,animation:{duration:0},y:{min:0,max:2e5,ticks:{stepSize:1e4}}}}),console.log("charts disaplyed")}else"sell"==Object.values(e)[2]&&u(n,"ask",e),"buy"==Object.values(e)[2]&&u(a,"bid",e)};let h=[],c=[],d=[],_=[];function f(t,e){h.length=0,d.length=0,c.length=0,_.length=0;let r=0;if("ask"==e)for(var o=t.iterator();null!==(i=o.next())&&(h.push(i.key),c.push(i.value),r++,50!=r););else{var i;for(o=t.iterator();null!==(i=o.prev())&&(h.push(i.key),c.push(i.value),r++,50!=r););}let s=h[0];d.push(h[0]),_.push(c[0]);for(let t=1;t<=50;t++){"ask"==e?s+=.05:s-=.05,s=Math.floor(100*s)/100;let t=!1;for(let e=0;e<=h.length;e++)s==h[e]&&(d.push(h[e]),_.push(c[e]),t=!0);t||(d.push(s),_.push(0))}"bid"==e?(chartbids.data.labels=d,chartbids.data.datasets[0].data=_,chartbids.update()):"ask"==e&&(chartasks.data.labels=d,chartasks.data.datasets[0].data=_,chartasks.update())}
//# sourceMappingURL=index.2783afb3.js.map
